"""
Модуль генерации RSA ключей
"""

import math
from main.utils.rsa.prime_generator import generate_large_prime
from gmpy2 import mpz

def generate_rsa(length: int = 1024) -> dict:
    """
    Метод генерации ключа
    """
    # p = generate_large_prime(length)
    p = mpz("242540484519211455285650017102146885052026022128605820509652066229254383252459055524318228344107886534991814454517688488698767742009534418783673863596407763662684550842028734541360229465425301882093546524878513288709516083487765103286748292679990853649008978255333361039615592038921570040914240588518681524942938710266969174285454673589000643316130837395477448425245221062010536975809759402308832246136129196079243898980398330276746552601080880779460259260877840107225739364549759896295412577354917138066704328274064291339276016070412900383302122138246347209855894291792309654906204968515106531276920651914628327125983941077888680231551763705175393429800204883019521089561704070038467111758308605260084059084935998199233870659986958091181998486367917691573961098141355582506000777523010721965638567306034353117516911397468282766604661925801881478592934305188851860556913566280057789396342038059846400152162805378748168956820856475505040291130919489838836182180600107528495938071867656237891376837720163012774460601729393290144285733673432276369446411552638764247693996976366519400710729524488467886941678245734471509178399879197223094814985420339915872696011530801698969044378131316247823563686619740650404151491188465546731666005543953829318890084559342013225382568577469783441063103828718175562372898754636579905157355880244536448859989390269796051827877043685055551846519003977249260446296766057802518351356017829556562832321742777693027737770279444385097796486431012750916310047196956040940128175179855684100341366687551894473963436986793363616203497750459439553924824811887117644411380020704671200230610720102963626621935670101843692094861478661357753972290970773306632721509056408976966558607824318813391440061921720210206187431320300844436516132319135885319853914905194086163674382334536492434906614732284087536490448482547522714970334144647522513643653803234946171532070190827341717141926613689215261051466420581009053077621390150276151156405284956842044131936646288334353742878712767795650963286591527436643971321301137151948749407060400957527022626155803015260493487538824504267512743440473542470152807212149652172741214192699165776172264102999255380604524934308983109027891375549518273406387452368354447108722909223938694549099780400623716873598409872507612374931521659361562545884154829950659825963615982785310284937867334029198833938358804530208753966888888856054275591455181252456717580226972435083188048163745361689182643872112495331489576277714410759125536086685632232547924904744550037143309706150742367295440597935766103239696096512468512918188421004498776402656867890635020960690862818757727888804445630959811806238831535004823111321491584403270718685049474437739399843123825308785530293146963564782016621169176560903568868298736725773610429205915010492390389389357341176764940974442060294716654804347451341882280179804781718583905720364527900156922428684918361481610491767638019163439174453260412120307739021246815935721002917900892624155791799355744719840416175025703523628695904817556000075778034599800637578525664786287505520425267273528688785935794360831551295387999330407253461078162781386447960709807107200703755182693310183572382691159027171634773404456992374538539241002215051295681161363134726469242507017219802930360945181820351723039303941026066319185375173741351441274559912190664498564280294003643930917331602640446716330703057247881563223517930308190933568273810754975837574949907508755827100163170071578153804742748040723388257433072078200443318876766198018078760708428579582912170795351309718432021123832038112316120613320836790648768207518859849147667095974181005560291574829270632898955961282575320698078801644845032081427621102285076149199717156458224958975908823488168749590741437876542864476441371002016314501232562623045354693270718412024871727918102682321616484604632326970764319668824142632224698842769030579401112502672564234373486727752059574241834754366845160085565304859799073834188274232984301793096698101918047608881710838270596340970190304104790581102685142210268192596142994320992550376921988609842087780279673152034542968233000850317069856153647500265707776153337515350143545125155090985301886368332907421651399307971330077393358480184696835168864052931531110117876794433458629541300222746252603484174986323600420956423017699571000938200467584608318439223647984452892797954621249652715551719546638666500248849875349071273985870847521287373593822525438202397053810771917759315248429307754425036923850696551700927447188417742336661950632855085607738914462121763739427609688546592317887477832791709450550460588896876630304411400406322390716663872867862334780502164152843457489701154952472392970811126534023167311297878187411933651491998780526346941789544484556658707972927927107357944470548868765437180649408949799473106755176867474559365619571051539142266155746943259766027055595939504250591512795353290509248552064097026833007847143778668676742326659519715619925253145136513504859")
    # q = generate_large_prime(length)
    q = mpz("563381586079844756567548456277112074805857136502466177540615822256339574288684385405030973839109041222070440159779010602504695961347947669348362114376232236549180642359201986223173898351588751711746964463503741690785960826990291726596631319844851123223485598489254604747407410389954304397797998365877970522543064266596911418768934535091733100770862553337428018223826751905921537492796106390478693051745478632662412949070882715655702436438126562068810563977579364237544335610972545795090632191613098224281036688373261453519819706696848361763369815234202576644182941470185272827704416315931285175462758313964110876921799750977785802652448294061985043962643246393096287182441531028418423743847744695166382256830354680819661791985867299997921142674152320269393734232456747468099119486544318742444440763637713609172804108554201486109488576154720280666027767944178344256173217524352723246901131006090020409751336147407970683966360230454288540216699681490420585279602241977058747716082440685325222377188447740609008316130726751105125236269428199762506129764800676189476091249326344023677708090121813203896814323438252481638472321625293282355726859689776769745426186397744169733995062173081801666479573985836560333649618511118317507215991775186650508438606854080273526536676352800428241979766903266864673671105763368392510000444159137594216736163763743791713942721827896504761945776464150136380254415044616297498678467243694557848732386171630916284417423944867589274532497586573844871702965872159952707717406508241625632067033236748917903375043824543776437836584968827294151076966599779201814638171095832506586173343696320501850279216666591688668070900742311939465677044626830430617488547165721309126578307995628611353407216852397251471401713103363472776442195093761228759077863328833309853729444260006586491945777684724978190503591980840324984929471812208196897324479720061092550410521940152073400134851259975255866024354475306123815254777145037855305930435570217399308858899559692541446025675240202574186567450235857258305114717134313724610475727815979030321797534820261090840456510906312394587085912788308354783502201967028997503466831455367646284009630949936535849929650381860649163312688561072782002770288856491119788679763858628741552205228091236081707325326464209933905555029161375435488059010633006323410073996676122682593393440798714735783219528171619897767986604599949432184883816576346670733014825867158855696659348536099245016630394135038938491711714141306708780883660244865023407442578193037160169449982256672149742630508874686961849058118488745507649343970730490369375696535707996752994577973079695921716293252840817502469106345963196636384984414433989158374307270764251730852770549167524390652049082411307497104993492333469284335118129714527723891739771773249709408588029540954535722688581020775943229175357236397613061455698469067133805564589149326075475418872102139378038066566312273931618065075954142947795614983257174989878328490234331529146242189582431903239172072154998334821370703638528588055669836215515855904586752246026118213795552201341988280847513582605869045384787382630199797617316115881714249748361184482380058246091666429527372636420001901677921447126877459056548808368313124528040520085019018795452850095400024282103325297402741688328439663459747319277416657787172909673300144828553635308274755982860148415984318190449735839035069755627938233648710992955947511016694573808068951341656143994288365166588320073683566420093021165522808928081803771144699086218238484846909832114675059194899147908737417263163828074157130857015591015755499095319151608950014041047819188327980994073412709583634836771562025461246452229109168856964292816846995548868673851050443248411090665201697391577315366004355556235265578840829719434953933841214966974260687562778725645751328706237919812989994621904169669062105300260755060804063083874529431465730029869897019689933464380524491791713780166389232147720731732307688625718315698990908441683777710275733903015343013142025776989429044190925480793468435347223031126620754485798478913755418768063275784846638633304229035221037986491666091741072551104659412638613270814534610226323893416484674640737830086377885696409589171392668160981618802679270807157863324148936641713850274315092035124269488789068710943787477570079275220618302981302271331740527674778762864044595390495554258606457285218085122051342543366254781974000266748749667677571440340779494834440625162748711607579066031885709552014255872599177768424744700919305178427716744890208586074219121576484053569184451235650804492069680202055174852770062588975625821255591261560352673456446764491042275161492046915086818719084299317041679082126666816980778930385296655243768119307159088629371084649312204281861824852495870686982521616694197793737220199224659468813570098165562536518348745590438320276938129052571512929842687085897038815586238528649054059750550153128358943206846590188003826790917326048273024041339507774070563259483")
    n = p * q
    phi = (p - 1) * (q - 1)

    e = 2
    while e < phi:
        if math.gcd(e, phi) == 1:
            break
        else:
            e += 1

    d = pow(e, -1, phi)

    return {"public_key": (e, n), "private_key": (d, n)}


if __name__ == '__main__':
    print(generate_rsa(1024))
